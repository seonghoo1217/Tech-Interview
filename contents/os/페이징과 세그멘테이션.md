# 페이징과 세그멘테이션

## 메모리 관리 기법
- Multi Programming System에서는 여러 Process를 수용하기 위해 주기억장치를 동적 분할하는 메모리 관리작업이 필요하다.

### 연속 메모리 관리
- 프로그램 전체가 하나의 커다란 공간에 연속적으로 할당되는 방법

**고정 분할 기법**
- 주기억장치가 고정된 파티션으로 분할 - internal fragmentation 발생
  **동적 분할 기법**
- 파티션들이 동적 생성되며 자신의 크기와 같은 파티션에 적재 - external fragmentation 발생

#### 메모리 단편화 (fragmentation)
- RAM에서 메모리의 공간이 작은 조각으로 나뉘어져 사용 가능한 메모리가 충분히 존재하지만 할당이 불가능한 상태

**내부 단편화(Internal Fragmentation)**
- Segmentation (Variable size)
- OS가 메모리할당시 프로세스가 필요한 양보다 더 많은 메모리를 할당할 시 메모리 낭비가 발생하는 상황
- ex.) A 프로그램 실행시 30MB 만을 사용하는 상황에서, OS가 100MB를 할당할 경우
- ![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F99811C435B19F90F02)
- ![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F9905AB435B19F9100D)

**외부 단편화(External Fragmentation)**
- Paging (Fixed size)
- 메모리가 할당되고 해제되는 작업이 **반복**될 때 작은 메모리 중간중간에 사용하지 않는 메모리가 많이 존재해서 총 메모리 공간은 충분하지만 **실제로 할당할 수** 없을때
- ![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Ft1.daumcdn.net%2Fcfile%2Ftistory%2F993EFB435B19F90F07)

#### 메모리 파편 해결법

1. 페이징 기법
    - 가상 메모리를 활용한, 외부 단편화를 해결하는 기법
        - 연속적이지 않은 공간도 활용할 수 있기 때문에 외부단편화 문제를 해결할 수 있다.
    - 보조기억장치, 가상메모리를 같은 크기의 블록으로 나눈 것을 **페이지**라고 하고 RAM을 페이지와 같은 크기로 나눈 것을 **프레임**이라고 한다.
        - 페이지: 고정 사이즈의 가상 메모리 내 프로세스 조각
        - 프레임: 페이지와 같은 크기의 주기억장치 메모리 조각.
        - 페이지를 사용해야 할때 프레임에 올리고 paging table을 통해 위치를 기억
    - 사용하지 않는 프레임을 페이지로 옮기고 필요한 메모리를 페이징하여, 프레임에 적재하는 방법
    - 페이지와 프레임을 대응시키기 위해 Page Mapping 과정이 필요해서 Paging table을 별도로 생성
    - 프로세스가 페이지 단위를 꽉 못채울 수 있으므로 내부 단편화가 발생할 수 있다.
        - 페이지 단위를 줄이면 내부단편화가 없어질수도 있으나, page mapping이 너무 많아지게 되므로 효율이 떨어질 수 있다.

**1-1. 단순 페이징**
- 각 프로세스는 프레임과 같은 길이의 페이지로 나뉜다.
- 외부 단편화가 생기지 않는다
- 내부 단편화가 생길 수 있다

**1-2. 가상 메모리 페이징**
- 단순 페이징과 반대로 모든 프로세스 페이지를 로드하지 않는다.
- 필요한 페이지가 있으면 table을 통해 부른다
- 외부 단편화가 생기진 않지만, table을 호출하는 방법을 사용하기에 overhead 발생가능성이 있다.

2. 세그멘테이션 기법
    - 가상 메모리를 활용한, 내부 단편화를 해결하는 기법
    - 세그먼테이션 기법은 가상메모리를 서로 크기가 다른 **논리적 단위인 세그먼트**로 분할하여, 메모리에 할당 후 실제 메모리 주소로 변환시킨다.
    - 각 세그먼트는 연속적인 공간에 저장
    - 프로세스가 필요한 메모리공간 만큼 할당해주기 때문에, 중간에 메모리를 해제하면 생기는 외부단편화 문제가 발생한다.
        - 프로그램의 중요한 부분과 중요하지 않은 부분을 따로 저장함으로써 보호와 공유 기능을 할 수 있다.
    - segment를 사용해야할 때 segment table을 통해서 mapping이 이루어진다.

**2-1. 단순 세그멘테이션**
- 각 프로세스가 여러 세그먼트로 나뉜다.
- 내부 단편화가 없다
- 동적 분할을 통한 overhead 감소
- 외부 단편화가 존재할 가능성이 있다.

**2-2. 가상메모리 세그멘테이션**
- 필요하지 않은 segment들은 로드되지 않는다.
- 필요한 세그먼트가 있으면 table을 통해 부른다.
- 내부 단편화가 없다.
- 복잡한 메모리 관리로 overhead 생길 수 있다.

### 불연속 메모리 관리
- 프로그램의 일부가 서로 다른 주소 공간에 할당되는 방법
- 대표적인 예시가 페이징과 세그멘테이션 
